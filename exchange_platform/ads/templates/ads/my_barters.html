{% extends 'base.html' %}

{% block content %}
  <div class="container mx-auto px-4 py-8">
    <h1 class="text-3xl font-bold mb-4">Мои бартеры</h1>

    <!-- Вкладки -->
    <div class="mb-6">
      <div class="flex border-b">
        <button id="tab-1" class="py-2 px-4 text-xl font-semibold focus:outline-none" onclick="openTab(1)">Ожидающие</button>
        <button id="tab-2" class="py-2 px-4 text-xl font-semibold focus:outline-none" onclick="openTab(2)">Принятые</button>
        <button id="tab-3" class="py-2 px-4 text-xl font-semibold focus:outline-none" onclick="openTab(3)">Отклоненные</button>
      </div>
    </div>

    <!-- Контент вкладок -->
    <div id="content-1" class="tab-content">
      <h2 class="text-2xl font-semibold mb-4">Ожидающие</h2>
      {% if pending_proposals %}
        <ul>
          {% for proposal in pending_proposals %}
            <li class="py-2">
              <div class="flex justify-between">
                <span>{{ proposal.ad_sender.title }} ↔ {{ proposal.ad_receiver.title }}</span>
                <span class="text-gray-500">Создано: {{ proposal.created_at }}</span>
              </div>
              <p class="text-gray-700">{{ proposal.comment }}</p>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>Нет ожидающих предложений.</p>
      {% endif %}
    </div>

    <div id="content-2" class="tab-content hidden">
      <h2 class="text-2xl font-semibold mb-4">Принятые</h2>
      {% if accepted_proposals %}
        <ul>
          {% for proposal in accepted_proposals %}
            <li class="py-2">
              <div class="flex justify-between">
                <span>{{ proposal.ad_sender.title }} ↔ {{ proposal.ad_receiver.title }}</span>
                <span class="text-gray-500">Создано: {{ proposal.created_at }}</span>
              </div>
              <p class="text-gray-700">{{ proposal.comment }}</p>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>Нет принятых предложений.</p>
      {% endif %}
    </div>

    <div id="content-3" class="tab-content hidden">
      <h2 class="text-2xl font-semibold mb-4">Отклоненные</h2>
      {% if declined_proposals %}
        <ul>
          {% for proposal in declined_proposals %}
            <li class="py-2">
              <div class="flex justify-between">
                <span>{{ proposal.ad_sender.title }} ↔ {{ proposal.ad_receiver.title }}</span>
                <span class="text-gray-500">Создано: {{ proposal.created_at }}</span>
              </div>
              <p class="text-gray-700">{{ proposal.comment }}</p>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p>Нет отклоненных предложений.</p>
      {% endif %}
    </div>
  </div>

  <script>
    // Функция для переключения вкладок
    function openTab(tabNumber) {
      // Скрыть все вкладки
      const contents = document.querySelectorAll('.tab-content');
      contents.forEach(content => content.classList.add('hidden'));

      // Убрать активность у всех кнопок
      const tabs = document.querySelectorAll('button');
      tabs.forEach(tab => tab.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600'));

      // Показать активную вкладку
      document.getElementById('content-' + tabNumber).classList.remove('hidden');
      document.getElementById('tab-' + tabNumber).classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
    }

    // Открыть первую вкладку по умолчанию
    openTab(1);
  </script>
{% endblock %}
